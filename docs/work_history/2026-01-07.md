# 작업 이력 - 2026-01-07

## 17:35 - choose_region 함수 개선 (EC2 없이 ECS/EKS만 있어도 동작)

### 변경 사항 (리전 선택)

- 변경된 파일: `ec2menu_v5.3.0_mac.py`
- 변경 내용:
  - `_check_region_resources()` 헬퍼 함수 추가: 리전별 EC2/ECS/EKS 리소스 존재 여부 확인
  - `choose_region()` 함수 수정: EC2 인스턴스만 검색하던 로직을 EC2/ECS/EKS 모두 검색하도록 변경
  - 리전 목록 출력 시 각 리전에 어떤 리소스(EC2, ECS, EKS)가 있는지 태그로 표시
- 이유: EC2 인스턴스가 없고 ECS/EKS 클러스터만 있는 환경에서 스크립트가 정상 동작하지 않는 문제 해결

### 코드 변경 (리전 검색)

```python
def _check_region_resources(manager: AWSManager, region: str) -> Dict[str, bool]:
    """리전에 EC2/ECS/EKS 리소스가 있는지 확인합니다."""
    result = {'ec2': False, 'ecs': False, 'eks': False}
    # EC2, ECS, EKS 각각 확인하여 결과 반환
    ...
```

- 리전 선택 화면에서 리소스 종류별 태그 표시:

```text
--- [ AWS Regions with Resources ] ---
  1) ap-northeast-2      [EC2, ECS]
  2) us-east-1           [EKS]
 99) 모든 리전 통합 뷰
```

### 영향도 (리전 선택)

- 영향받는 컴포넌트: 리전 선택 기능
- 주의사항:
  - 기존 EC2만 있는 환경에서도 동일하게 동작
  - 리전 검색 시 EC2, ECS, EKS 모두 확인하므로 검색 시간이 약간 늘어날 수 있음

---

## 17:45 - kubectl logs/exec 터미널을 iTerm2로 열리도록 수정

### 변경 사항 (kubectl 터미널)

- 변경된 파일: `ec2menu_v5.3.0_mac.py`
- 변경 내용:
  - `launch_kubectl_exec()` 함수: Terminal.app 직접 호출 → `launch_terminal_session()` 사용
  - `launch_kubectl_logs()` 함수: Terminal.app 직접 호출 → `launch_terminal_session()` 사용
- 이유: kubectl logs/exec 시 Terminal.app이 열리던 문제를 iTerm2로 열리도록 수정

### 코드 변경 (kubectl 함수)

변경 전:

```python
if IS_MAC:
    script = f'''
    tell application "Terminal"
        activate
        do script "{cmd_str}"
    end tell
    '''
    subprocess.Popen(['osascript', '-e', script])
```

변경 후:

```python
if IS_MAC:
    launch_terminal_session(cmd_parts, use_iterm=True)
```

### 영향도 (kubectl 터미널)

- 영향받는 컴포넌트: EKS Pod 로그 조회, Pod exec 접속
- 주의사항: iTerm2가 설치되어 있으면 iTerm2 사용, 없으면 Terminal.app 사용

---
